USE Airbase;
CREATE TABLE AIRPLANE
(
AIRPLANE_ID INT PRIMARY KEY IDENTITY(1,1),
ÌÀÐÊÀ_ÑÀÌÎËÅÒÀ NVARCHAR (20) NOT NULL,
)

CREATE TABLE AIRPORT
(
ÈÍÄÅÊÑ INT PRIMARY KEY,
ÍÀÈÌÅÍÎÂÀÍÈÅ NVARCHAR (30),
ÐÀÑÏÎËÎÆÅÍÈÅ NVARCHAR (30)
)

CREATE TABLE AVIACOMPANY
(
ÀÂÈÀÊÎÌÏÀÍÈß NVARCHAR(30),
AIRPLANE_ID INT REFERENCES AIRPLANE(AIRPLANE_ID),
ÊÎËÈ×ÅÑÒÂÎ INT NOT NULL DEFAULT 0,
ÈÍÄÅÊÑ INT NOT NULL  REFERENCES AIRPORT(ÈÍÄÅÊÑ),
CONSTRAINT PK_ÀÂÈÀÊÎÌÏÀÍÈß PRIMARY KEY (ÀÂÈÀÊÎÌÏÀÍÈß,AIRPLANE_ID)
)

INSERT INTO AIRPLANE VALUES('BOEING-737')
INSERT INTO AIRPLANE VALUES('ÒÓ-154')
INSERT INTO AIRPLANE VALUES ('ATR-72')
INSERT INTO AIRPORT VALUES(442080,'ØÅÐÅÌÅÒÜÅÂÎ','ã.Ìîñêâà')
INSERT INTO AVIACOMPANY VALUES ('S7',1,5,442080)



SELECT AVIACOMPANY.ÀÂÈÀÊÎÌÏÀÍÈß,AIRPLANE.ÌÀÐÊÀ_ÑÀÌÎËÅÒÀ,AVIACOMPANY.ÊÎËÈ×ÅÑÒÂÎ,AIRPORT.ÍÀÈÌÅÍÎÂÀÍÈÅ FROM AVIACOMPANY
JOIN AIRPLANE ON AVIACOMPANY.AIRPLANE_ID = AIRPLANE.AIRPLANE_ID
JOIN AIRPORT ON AVIACOMPANY.ÈÍÄÅÊÑ = AIRPORT.ÈÍÄÅÊÑ

ALTER TABLE AIRPLANE 
ADD ÄÀÒÀ_ÂÛÏÓÑÊÀ DATE DEFAULT'01-01-1900' 

ALTER TABLE AIRPORT
ADD ÄËÈÍÀ_ÂÏÏ INT CHECK(ÄËÈÍÀ_ÂÏÏ > 0)

ALTER TABLE AIRPORT
ADD CLASS NVARCHAR(5)

ALTER TABLE AVIACOMPANY
ADD CHECK (ÈÍÄÅÊÑ >1)

ALTER TABLE AIRPORT
DROP COLUMN ÄËÈÍÀ_ÂÏÏ


UPDATE AIRPORT
SET CLASS = CASE
WHEN ÄËÈÍÀ_ÂÏÏ > 3200
THEN 'A'
ELSE
'B' END;
